{"ast":null,"code":"import _regeneratorRuntime from\"D:/Git_Hub/JMEDUSERVER/react/sources/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Git_Hub/JMEDUSERVER/react/sources/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Git_Hub/JMEDUSERVER/react/sources/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from\"react\";import DataTableV1 from\"../../Components/dataTableV1/DataTableV1\";import SearchBox from\"../../Components/searchBox/SearchBox\";import{useState}from\"react\";import BasicBox from\"../../Components/manage-box/BasicBox\";import axios from\"axios\";import{EDIT_STUDENT}from\"../../constants/searchFilter\";import{Toast,notify}from\"../../template/Toastify\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function AttendanceStudent(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),studnetArray=_useState4[0],setStudentArray=_useState4[1];var _useState5=useState({text:\"\",option:\"\",submit:false}),_useState6=_slicedToArray(_useState5,2),editText=_useState6[0],setEditText=_useState6[1];if(editText.text&&studnetArray.length>1&&editText.submit){dataSubmit_all();setEditText({text:\"\",option:\"\",submit:false});// 실행 후 초기화\n}//배열 정수형으로 변환\nfunction arrayToSqlInString(arr){return arr.map(function(item){return\"'\".concat(item,\"'\");}).join(\", \");}useEffect(function(){loging();},[]);//데이터 가져오기\nfunction loging(){return _loging.apply(this,arguments);}//데이터 수정 (한번에)\nfunction _loging(){_loging=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/server/students_view\"),{});case 3:response=_context.sent;setData(response.data.students);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return _loging.apply(this,arguments);}function dataSubmit_all(){return _dataSubmit_all.apply(this,arguments);}//데이터 테이블에 보일 컬럼\nfunction _dataSubmit_all(){_dataSubmit_all=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.put(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/server/students_view_update_all\"),{editObject:editText,editTarget:arrayToSqlInString(studnetArray)});case 3:response=_context2.sent;if(response.data.success){notify({type:\"success\",text:\"수정이 완료됐습니다. 확인을 위해서는 새로고침을 해주세요\"});}else{notify({type:\"error\",text:\"수정 중 오류발생.\"});}_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 10:case\"end\":return _context2.stop();}},_callee2,null,[[0,7]]);}));return _dataSubmit_all.apply(this,arguments);}var columns=[{columnName:\"이름\",data:\"name\"},{columnName:\"전화번호\",data:\"contact\"},{columnName:\"부모님 전화번호\",data:\"contact_parent\"}];return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(BasicBox,{children:[/*#__PURE__*/_jsx(SearchBox,{setData:setData,option:\"student\"}),/*#__PURE__*/_jsx(DataTableV1,{title:\"학생 출석관리 테이블\",columns:columns,datas:data,type:\"student\",setStudentArray:setStudentArray,editType:EDIT_STUDENT,setEditText:setEditText})]}),/*#__PURE__*/_jsx(Toast,{})]});}","map":{"version":3,"names":["React","useEffect","DataTableV1","SearchBox","useState","BasicBox","axios","EDIT_STUDENT","Toast","notify","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AttendanceStudent","_useState","_useState2","_slicedToArray","data","setData","_useState3","_useState4","studnetArray","setStudentArray","_useState5","text","option","submit","_useState6","editText","setEditText","length","dataSubmit_all","arrayToSqlInString","arr","map","item","concat","join","loging","_loging","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","post","process","env","REACT_APP_SERVER_URL","sent","students","t0","console","error","stop","_dataSubmit_all","_callee2","_callee2$","_context2","put","editObject","editTarget","success","type","columns","columnName","children","title","datas","editType"],"sources":["D:/Git_Hub/JMEDUSERVER/react/sources/src/pages/student/attendance_student.jsx"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport DataTableV1 from \"../../Components/dataTableV1/DataTableV1\";\nimport SearchBox from \"../../Components/searchBox/SearchBox\";\nimport { useState } from \"react\";\nimport BasicBox from \"../../Components/manage-box/BasicBox\";\nimport axios from \"axios\";\nimport { EDIT_STUDENT } from \"../../constants/searchFilter\";\nimport { Toast, notify } from \"../../template/Toastify\";\n\nexport default function AttendanceStudent() {\n  const [data, setData] = useState();\n\n  const [studnetArray, setStudentArray] = useState([]);\n  const [editText, setEditText] = useState({\n    text: \"\",\n    option: \"\",\n    submit: false,\n  });\n\n  if (editText.text && studnetArray.length > 1 && editText.submit) {\n    dataSubmit_all();\n    setEditText({ text: \"\", option: \"\", submit: false }); // 실행 후 초기화\n  }\n\n  //배열 정수형으로 변환\n  function arrayToSqlInString(arr) {\n    return arr.map((item) => `'${item}'`).join(\", \");\n  }\n\n  useEffect(() => {\n    loging();\n  }, []);\n\n  //데이터 가져오기\n  async function loging() {\n    try {\n      const response = await axios.post(\n        `${process.env.REACT_APP_SERVER_URL}/server/students_view`,\n        {}\n      );\n      setData(response.data.students);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  //데이터 수정 (한번에)\n  async function dataSubmit_all() {\n    try {\n      const response = await axios.put(\n        `${process.env.REACT_APP_SERVER_URL}/server/students_view_update_all`,\n        { editObject: editText, editTarget: arrayToSqlInString(studnetArray) }\n      );\n      if (response.data.success) {\n        notify({\n          type: \"success\",\n          text: \"수정이 완료됐습니다. 확인을 위해서는 새로고침을 해주세요\",\n        });\n      } else {\n        notify({\n          type: \"error\",\n          text: \"수정 중 오류발생.\",\n        });\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  //데이터 테이블에 보일 컬럼\n  const columns = [\n    { columnName: \"이름\", data: \"name\" },\n    { columnName: \"전화번호\", data: \"contact\" },\n    { columnName: \"부모님 전화번호\", data: \"contact_parent\" },\n  ];\n\n  return (\n    <>\n      <BasicBox>\n        <SearchBox setData={setData} option={\"student\"}></SearchBox>\n        <DataTableV1\n          title={\"학생 출석관리 테이블\"}\n          columns={columns}\n          datas={data}\n          type=\"student\"\n          setStudentArray={setStudentArray}\n          editType={EDIT_STUDENT}\n          setEditText={setEditText}\n        />\n      </BasicBox>\n      <Toast />\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}